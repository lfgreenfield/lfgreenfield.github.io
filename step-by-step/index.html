<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>Step-By-Step Service Locations</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    
    <link rel="stylesheet" href="css/normalize.css" />    
    <link rel="stylesheet" href="css/leaflet.css" />
    <link rel="stylesheet" href="css/Leaflet.vector-markers.css">
    <link rel="stylesheet" href="css/styles.css">

</head>

<body>  

    <header>
        <a href="http://sbs.cornettims.com/"><img src ="images/SBSLogo-sm.png" alt="LOGO" class='logo'></a>
        <h1>Search using address, street, city, state, and zipcode. Can filter services. Hover on markers for info.</h1>
    </header>

    <div id='map'></div>
<<<<<<< HEAD

    <script>
        var options = {
            center: [38.0400,-84.4650],
            zoom: 12
        }
       
        var map = L.map('map', options);
        
        var tiles = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
	maxZoom: 19,
	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
});
   
        map.addLayer(tiles); 
        
        new L.Control.GeoSearch({
            provider: new L.GeoSearch.Provider.Esri()
        }).addTo(map);
                                                                                       
        var layerInfo2 = {
            abuseSupport: {name: "Abuse Counseling and Support", color: 'red'},
            residentialAbuseHelp: {name: "Residential Substance Abuse Help", color: 'blue'},
            outpatientAbuseHelp: {name: "Outpatient Substance Abuse Assessment/Treatment/Support", color: 'purple'},
            emergencyShelters: {name: "Emergency Shelters", color: 'orange'},
            indigentHealthcare: {name: "Indigent Healthcare", color: 'lightgreen'},
            mentalHealth: {name: "Mental Health Assessment\/Counseling\/Support Groups", color: 'darkred'},
            clothfoodhousing: {name: "Clothing, Food, Housing, Financial Aid", color: 'green'},
            pregnancy: {name: "Pregnancy and Parenting", color: 'darkpurple'},
            education: {name: "Education", color: 'pink'},
            childcare: {name: "Childcare", color: 'beige'},
            employment: {name: "Employment", color: 'cadetblue'},
            addtlResources: {name: "Additional Resources", color: 'lightgray'}        
        }
        
        var geoJsonLayers = {}; 
               
        for (var layer in layerInfo2) {
           geoJsonLayers[layer] = L.geoJson(serviceDatabase, {       
            
                pointToLayer: function(feature, latlng) {
                    
                    var categoryMarker = L.AwesomeMarkers.icon({
                        markerColor: layerInfo2[layer].color,
                    });
                    
                    return L.marker (latlng, {icon: categoryMarker});                
                    
                },
                filter: function(feature) {
                   
                    if (feature.properties.ServiceCat == layerInfo2[layer].name) {
                        return feature;
                        
                    }
                },
                onEachFeature: function(feature, layer) {
                    var props = feature.properties;
                    var content = "<b>"+props.ServiceNam+"</b><br>"+props.Address+" "+props.City+", "+props.State+" "+props.ZipCode+"<br>";
                
                    layer.bindPopup(content);
                    
                    layer.on('click', function() {
                        info.update(props);                         
                    });
                        
                    },       
            
          }).addTo(map); 
           
        }
        
        var categoryLayers = {
            "Abuse Counseling & Support": geoJsonLayers.abuseSupport,
            "Residential Substance Abuse Help": geoJsonLayers.residentialAbuseHelp,
            "Outpatient Substance Abuse Treatment & Support": geoJsonLayers.outpatientAbuseHelp,
            "Emergency Shelters": geoJsonLayers.emergencyShelters,
            "Indigent Healthcare": geoJsonLayers.indigentHealthcare,
            "Mental Health Assessment/Counseling/Support Groups": geoJsonLayers.mentalHealth,
            "Clothing, Food, Housing, Finance Aid": geoJsonLayers.clothfoodhousing,
            "Pregnancy and Parenting": geoJsonLayers.pregnancy,
            "Education": geoJsonLayers.education,
            "Childcare": geoJsonLayers.childcare,
            "Employment": geoJsonLayers.employment,
            "Additional Resources": geoJsonLayers.addtlResources
          
        }        
        
        L.control.layers(null, categoryLayers, {collapsed:false}).addTo(map);
        
        var info = L.control();
        info.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'info');           
            return div;
        };
        
        info.update = function (props) {
           
           var html = "<h3>"+props.ServiceNam+"</h3>"+
                    "Category: <b>"+props.ServiceCat+"</b><br>"+
                    "Address: <b>"+props.Address+" "+props.City+", "+props.State+" "+props.ZipCode+"</b><br>"+
                    "Primary Phone: <b>"+props.PrimaryPho+"</b><br>"+
                    "Secondary Phone: <b>"+props.SecondaryP+"</b><br>"+
                    "Website: <b>"+props.Website+"</b><br>"
           
           $(".info").html(html);
               
        };
        info.addTo(map);
                                    
       </script>
=======
    <div class='info'></div>
>>>>>>> LOADING
    
    <script src="data/ServiceDatabase.js"></script>

    <script src="js/leaflet.js"></script>
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/l.control.geosearch.js"></script>
    <script src="js/l.geosearch.provider.esri.js"></script>
    <script src="js/Leaflet.vector-markers.js"></script>
    <script src="js/map.js"></script>

</body>

</html>